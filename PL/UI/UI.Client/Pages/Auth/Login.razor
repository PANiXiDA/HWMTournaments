@page "/login"

<div class="login-card">
    <h2 class="login-title">Вход</h2>

    <EditForm Model="@_loginRequest" OnValidSubmit="HandleLogin" class="form-container">
        <DataAnnotationsValidator />
        <ValidationSummary class="validation-summary" />

        <div class="form-group">
            <label class="form-label" for="login">@_loginRequest.GetDisplayName(property => property.Login)</label>
            <InputText id="login" @bind-Value="_loginRequest.Login" class="form-input" />
        </div>

        <div class="form-group">
            <label class="form-label" for="password">@_loginRequest.GetDisplayName(property => property.Password)</label>
            <InputText id="password" @bind-Value="_loginRequest.Password" type="password" class="form-input" />
        </div>

        <div class="buttons-row">
            <button type="submit" class="action-button">Войти</button>
            <button type="button" class="action-button" @onclick="@(() => Navigation.NavigateTo("/register"))">Регистрация</button>
        </div>

        <div class="links-container">
            <button type="button" class="link-button" @onclick="ConfirmEmail">Подтвердить почту</button>
            <button type="button" class="link-button" @onclick="ForgotPassword">Забыли пароль?</button>
        </div>
    </EditForm>
</div>

<Modal TModel="EmailConfirmationRequest"
       Title="Подтверждение e‑mail"
       SubmitText="Отправить"
       IsOpen="@_emailConfirmationModalOpen"
       IsOpenChanged="@(eventCallback => _emailConfirmationModalOpen = eventCallback)"
       InitialModel="@_emailConfirmationRequest"
       EndpointUrl="/api/v1/users/email-confirmation"
       HttpMethod="PATCH"
       OnSuccess="OnConfirmSuccess" />